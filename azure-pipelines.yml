trigger:
  batch: true
  branches:
    include:
      - "*"

  paths:
    include:
      - src/*
      - tests/*
      - tools/*
      - azure-pipelines.yml

pr: none

pool:
  vmImage: windows-latest

stages:
  - stage: CI
    jobs:
    - job: BuildModule
      steps:
        - task: gittools.gitversion.gitversion-task.GitVersion@5
          displayName: GitVersion
          inputs:
            configFilePath: GitVersion.yml

        - task: PowerShell@1
          displayName: 'Execute Build'
          inputs:
            scriptName: tools/build.ps1

        - task: PublishTestResults@2
          displayName: 'Publish Test Results **\TEST_*.xml'
          inputs:
            testResultsFormat: NUnit
            testResultsFiles: '**\TEST_*.xml'
          continueOnError: true
